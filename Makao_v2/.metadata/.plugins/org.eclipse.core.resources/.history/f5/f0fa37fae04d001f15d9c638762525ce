package client;


import java.awt.Dimension;
import java.awt.Point;
import java.awt.Rectangle;
import java.awt.image.*;
import java.io.File;
import java.util.Hashtable;

import javax.imageio.ImageIO;

public class ImagesBuffer {
    private static ImagesBuffer iBuffer = null;
	private Hashtable<String,BufferedImage> buff = new Hashtable<String,BufferedImage>();
    private ImagesBuffer(){}
	
    public static ImagesBuffer getInstance() 
    {
		if (iBuffer== null) iBuffer=new ImagesBuffer();
    	// TODO Auto-generated method stub
		return iBuffer;
	}
    private BufferedImage read(String source)
    {
    	BufferedImage bimg = null;
		try {  
		        bimg = ImageIO.read(new File(source));  
		    } catch (Exception e) {  
		          e.printStackTrace();  
		    }
		 return bimg;
    }
	public void addEntry(String key,String source) 
	{
		BufferedImage bimg = read(source);
		buff.put(key, bimg);		
	}

	public void splitImagesFromSource(String source, int i, int j, int number) 
	{
		BufferedImage temp = read(source);
		int sX=0,sY=0;
		for (int k=0;k<number;k++)
		{
			Raster raster = temp.getData(new Rectangle(new Point(sX,sY),new Dimension(i,j)));
			BufferedImage im = new BufferedImage(0,0,0);
			im.setData(raster);
			String val = String.valueOf(k);
			buff.put(val, im);
			
			sX+=i;
			if (sX > temp.getWidth()){sX=0; sY+=j;}
		}
		// TODO Auto-generated method stub
		
	}

	public BufferedImage getEntry(String key) 
	{
		// TODO Auto-generated method stub
		return buff.get(key);
	}

	public int size() {
		return buff.size();
	}

	public void removeEntry(String key) {
		buff.remove(key);
		
	}

}
